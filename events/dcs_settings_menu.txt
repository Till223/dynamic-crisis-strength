namespace = dcs
#settings menu
country_event = {
    id = dcs.400
    title = dcs_menu.title
	is_triggered_only = yes
    trigger = {
        is_ai = no
    }
    picture = GFX_evt_fleet_evil
	desc =  {
        text = dcs_menu.desc
        trigger = { 
            event_target:global_event_country = { 
                NOT = { has_country_flag = dcs_custom_crisis_multiplier_flag  }
                has_dcs_negate_crisis_strength = yes
            } 
        }
    }
    desc =  {
        text = dcs_menu.desc.no_vanilla_negation
        trigger = { 
            event_target:global_event_country = { 
                NOT = { has_country_flag = dcs_custom_crisis_multiplier_flag } 
                has_dcs_negate_crisis_strength = no
            } 
        }
    }
    desc =  {
        text = dcs_menu.desc_custom_modifier
        trigger = { 
            event_target:global_event_country = { 
                has_country_flag = dcs_custom_crisis_multiplier_flag 
                has_dcs_negate_crisis_strength = yes
            } 
        }
    }
    desc =  {
        text = dcs_menu.desc_custom_modifier.no_vanilla_negation
        trigger = { 
            event_target:global_event_country = { 
                has_country_flag = dcs_custom_crisis_multiplier_flag 
                has_dcs_negate_crisis_strength = no
            } 
        }
    }

    immediate = {
        dcs_ensure_global_initialization = yes
        
        #prevent errors from missing variables in text.
        if = {
            limit = { NOT = { exists = event_target:last_crisis_empire} }
            event_target:global_event_country = { 
                set_variable = { which = dcs_universe_strength value = 0 }
                set_variable = { which = dcs_crisis_multiplier value = 0 }
                set_variable = { which = dcs_subtract_vanilla_crisis value = 0 }
                set_variable = { which = dcs_applied_multiplier value = 0 }
                set_variable = { which = dcs_equivalent_vanilla_crisis value = 0 }
                set_variable = { which = dcs_crisis_fleet_power_input value = 180000 }
                save_global_event_target_as = last_crisis_empire
            }
        }
    }

    option = {
        trigger = { has_dcs_affect_mid_game_crisis = yes }
        name = dcs_menu.dcs_affect_mid_game_crisis_disable
        hidden_effect = {
            if = { limit = { has_global_flag = dcs_affect_mid_game_crisis }
                remove_global_flag = dcs_affect_mid_game_crisis
            } else = {
                set_global_flag = dcs_affect_mid_game_crisis
            }
            every_country = {
                country_event = {
                    id = dcs.101
                }
            }
            country_event = { id = dcs.400 }
        }
    }

    option = {
        trigger = { has_dcs_affect_mid_game_crisis = no }
        name = dcs_menu.dcs_affect_mid_game_crisis_enable
        hidden_effect = {
            if = { limit = { has_global_flag = dcs_affect_mid_game_crisis }
                remove_global_flag = dcs_affect_mid_game_crisis
            } else = {
                set_global_flag = dcs_affect_mid_game_crisis
            }
            every_country = {
                country_event = {
                    id = dcs.101
                }
            }
            country_event = { id = dcs.400 }
        }
    }

    option = {
        trigger = { has_dcs_allow_negative_multiplier = yes }
        name = dcs_menu.dcs_allow_negative_multiplier_disable
        hidden_effect = {
            if = { limit = { has_global_flag = dcs_allow_negative_multiplier }
                remove_global_flag = dcs_allow_negative_multiplier
            } else = {
                set_global_flag = dcs_allow_negative_multiplier
            }
            every_country = {
                country_event = {
                    id = dcs.101
                }
            }
            country_event = { id = dcs.400 }
        }
    }

    option = {
        trigger = { has_dcs_allow_negative_multiplier = no }
        name = dcs_menu.dcs_allow_negative_multiplier_enable
        hidden_effect = {
            if = { limit = { has_global_flag = dcs_allow_negative_multiplier }
                remove_global_flag = dcs_allow_negative_multiplier
            } else = {
                set_global_flag = dcs_allow_negative_multiplier
            }
            every_country = {
                country_event = {
                    id = dcs.101
                }
            }
            country_event = { id = dcs.400 }
        }
    }

    option = {
        trigger = { has_dcs_negate_crisis_strength = yes }
        name = dcs_menu.dcs_negate_crisis_strength_disable
        hidden_effect = {
            if = { limit = { has_global_flag = dcs_negate_crisis_strength }
                remove_global_flag = dcs_negate_crisis_strength
            } else = {
                set_global_flag = dcs_negate_crisis_strength
            }
            every_country = {
                country_event = {
                    id = dcs.101
                }
            }
            country_event = { id = dcs.400 }
        }
    }

    option = {
        trigger = { has_dcs_negate_crisis_strength = no }
        name = dcs_menu.dcs_negate_crisis_strength_enable
        hidden_effect = {
            if = { limit = { has_global_flag = dcs_negate_crisis_strength }
                remove_global_flag = dcs_negate_crisis_strength
            } else = {
                set_global_flag = dcs_negate_crisis_strength
            }
            every_country = {
                country_event = {
                    id = dcs.101
                }
            }
            country_event = { id = dcs.400 }
        }
    }

    option = {
        trigger = { event_target:global_event_country = { not = { has_country_flag = dcs_custom_crisis_multiplier_flag } } }
        name = dcs_menu.enable_custom_modifier
        hidden_effect = {
            event_target:global_event_country = { set_country_flag = dcs_custom_crisis_multiplier_flag }
            every_country = {
                country_event = {
                    id = dcs.101
                }
            }
            country_event = { id = dcs.400 }
        }
    }

    option = {
        trigger = { event_target:global_event_country = { has_country_flag = dcs_custom_crisis_multiplier_flag } }
        name = dcs_menu.disable_custom_modifier
        hidden_effect = {
            event_target:global_event_country = { remove_country_flag = dcs_custom_crisis_multiplier_flag }
            every_country = {
                country_event = {
                    id = dcs.101
                }
            }
            country_event = { id = dcs.400 }
        }
    }

    option = {
        trigger = { event_target:global_event_country = { not = { has_country_flag = dcs_custom_crisis_multiplier_flag } } }
        name = dcs_menu.increase_calculation_multiplier_5
        custom_tooltip = dcs_menu.increase_calculation_multiplier.tooltip
        hidden_effect = {
            event_target:global_event_country = { 
                change_variable = { which = dcs_calculation_multiplier value = 0.5 }
            }
            every_country = {
                country_event = {
                    id = dcs.101
                }
            }
            country_event = { id = dcs.400 }
        }
    }

    option = {
        trigger = { event_target:global_event_country = { not = { has_country_flag = dcs_custom_crisis_multiplier_flag } } }
        name = dcs_menu.increase_calculation_multiplier
        custom_tooltip = dcs_menu.increase_calculation_multiplier.tooltip
        hidden_effect = {
            event_target:global_event_country = { 
                change_variable = { which = dcs_calculation_multiplier value = 0.1 }
            }
            every_country = {
                country_event = {
                    id = dcs.101
                }
            }
            country_event = { id = dcs.400 }
        }
    }

    option = {
        trigger = { event_target:global_event_country = { not = { has_country_flag = dcs_custom_crisis_multiplier_flag } } }
        name = dcs_menu.decrease_calculation_multiplier
        custom_tooltip = dcs_menu.decrease_calculation_multiplier.tooltip
        hidden_effect = {
            event_target:global_event_country = { 
                subtract_variable = { which = dcs_calculation_multiplier value = 0.1 }
            }
            every_country = {
                country_event = {
                    id = dcs.101
                }
            }
            country_event = { id = dcs.400 }
        }
    }

    option = {
        trigger = { event_target:global_event_country = { not = { has_country_flag = dcs_custom_crisis_multiplier_flag } } }
        name = dcs_menu.decrease_calculation_multiplier_5
        custom_tooltip = dcs_menu.decrease_calculation_multiplier.tooltip
        hidden_effect = {
            event_target:global_event_country = { 
                subtract_variable = { which = dcs_calculation_multiplier value = 0.5 }
            }
            every_country = {
                country_event = {
                    id = dcs.101
                }
            }
            country_event = { id = dcs.400 }
        }
    }

    option = {
        trigger = { event_target:global_event_country = { not = { has_country_flag = dcs_custom_crisis_multiplier_flag } } }
        name = dcs_menu.increase_static_offset_1
        hidden_effect = {
            event_target:global_event_country = { 
                change_variable = { which = dcs_static_offset value = 1 }
            }
            every_country = {
                country_event = {
                    id = dcs.101
                }
            }
            country_event = { id = dcs.400 }
        }
    }

    option = {
        trigger = { event_target:global_event_country = { not = { has_country_flag = dcs_custom_crisis_multiplier_flag } } }
        name = dcs_menu.decrease_static_offset_1
        hidden_effect = {
            event_target:global_event_country = { 
                subtract_variable = { which = dcs_static_offset value = 1 }
            }
            every_country = {
                country_event = {
                    id = dcs.101
                }
            }
            country_event = { id = dcs.400 }
        }
    }

    option = {
        trigger = { event_target:global_event_country = { has_country_flag = dcs_custom_crisis_multiplier_flag } }
        name = dcs_menu.increase_custom_modifier_5
        hidden_effect = {
            event_target:global_event_country = { 
                change_variable = { which = dcs_custom_crisis_multiplier value = 5 } 
            }
            every_country = {
                country_event = {
                    id = dcs.101
                }
            }
            country_event = { id = dcs.400 }
        }
    }

    option = {
        trigger = { event_target:global_event_country = { has_country_flag = dcs_custom_crisis_multiplier_flag } }
        name = dcs_menu.increase_custom_modifier_0.1
        hidden_effect = {
            event_target:global_event_country = { 
                change_variable = { which = dcs_custom_crisis_multiplier value = 0.1 } 
            }
            every_country = {
                country_event = {
                    id = dcs.101
                }
            }
            country_event = { id = dcs.400 }
        }
    }

    option = {
        trigger = { event_target:global_event_country = { has_country_flag = dcs_custom_crisis_multiplier_flag } }
        name = dcs_menu.increase_custom_modifier_0.1
        hidden_effect = {
            event_target:global_event_country = { 
                change_variable = { which = dcs_custom_crisis_multiplier value = 0.1 } 
            }
            every_country = {
                country_event = {
                    id = dcs.101
                }
            }
            country_event = { id = dcs.400 }
        }
    }

    option = {
        trigger = { event_target:global_event_country = { has_country_flag = dcs_custom_crisis_multiplier_flag } }
        name = dcs_menu.decrease_custom_modifier_1
        hidden_effect = {
            event_target:global_event_country = { 
                subtract_variable = { which = dcs_custom_crisis_multiplier value = 1 } 
            }
            every_country = {
                country_event = {
                    id = dcs.101
                }
            }
            country_event = { id = dcs.400 }
        }
    }

    option = {
        trigger = { event_target:global_event_country = { has_country_flag = dcs_custom_crisis_multiplier_flag } }
        name = dcs_menu.decrease_custom_modifier_1
        hidden_effect = {
            event_target:global_event_country = { 
                subtract_variable = { which = dcs_custom_crisis_multiplier value = 1 } 
            }
            every_country = {
                country_event = {
                    id = dcs.101
                }
            }
            country_event = { id = dcs.400 }
        }
    }

    option = {
        trigger = { event_target:global_event_country = { has_country_flag = dcs_custom_crisis_multiplier_flag } }
        name = dcs_menu.decrease_custom_modifier_5
        hidden_effect = {
            event_target:global_event_country = { 
                subtract_variable = { which = dcs_custom_crisis_multiplier value = 5 } 
            }
            every_country = {
                country_event = {
                    id = dcs.101
                }
            }
            country_event = { id = dcs.400 }
        }
    }

    option = {
        name = dcs_menu.close
        default_hide_option = yes
    }
}